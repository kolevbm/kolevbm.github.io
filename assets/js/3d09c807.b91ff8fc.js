"use strict";(self.webpackChunktaking_notes=self.webpackChunktaking_notes||[]).push([[3917],{9485:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"linux/networking/bridges","title":"Notes on Linux Bridges","description":"Hardware:","source":"@site/docs/linux/networking/bridges.mdx","sourceDirName":"linux/networking","slug":"/linux/networking/bridges","permalink":"/docs/linux/networking/bridges","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"sidebar_label":"Bridges","displayed_sidebar":"linuxSidebar"},"sidebar":"linuxSidebar","previous":{"title":"Basics","permalink":"/docs/linux/networking/basics"},"next":{"title":"Iptables","permalink":"/docs/linux/networking/iptables"}}');var i=t(4848),s=t(8453);const d={sidebar_label:"Bridges",displayed_sidebar:"linuxSidebar"},c="Notes on Linux Bridges",l={},o=[{value:"Hardware:",id:"hardware",level:2},{value:"Network Overview",id:"network-overview",level:2},{value:"Notes",id:"notes",level:2},{value:"Tasks",id:"tasks",level:2},{value:"0. Prepare devices",id:"0-prepare-devices",level:3},{value:"RADXA",id:"radxa",level:4},{value:"DeviceA, Windows Machine",id:"devicea-windows-machine",level:4},{value:"DeviceB, Luckfox",id:"deviceb-luckfox",level:4},{value:"1. Create bridge on the host device (RADXA) between <code>lan2</code> and <code>lan3</code> call it <code>br0</code>",id:"1-create-bridge-on-the-host-device-radxa-between-lan2-and-lan3-call-it-br0",level:3},{value:"2. Connect deviceA to <code>eth1</code> and deviceB to <code>eht2</code> set static IPs in network 172.16.1.0/24",id:"2-connect-devicea-to-eth1-and-deviceb-to-eht2-set-static-ips-in-network-172161024",level:3},{value:"Checks",id:"checks",level:4},{value:"3. Set an ip address of the bridge br0 so we can have access to both devices from the host",id:"3-set-an-ip-address-of-the-bridge-br0-so-we-can-have-access-to-both-devices-from-the-host",level:3},{value:"Checks",id:"checks-1",level:4}];function a(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"notes-on-linux-bridges",children:"Notes on Linux Bridges"})}),"\n",(0,i.jsx)(n.h2,{id:"hardware",children:"Hardware:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"RADXA E54C network computer"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Operating System: Debian GNU/Linux 12 (bookworm)\r\nKernel: Linux 6.1.84-6-rk2410\r\nArchitecture: arm64\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Luckfox Pico pro/Max"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'NAME=Buildroot\r\nVERSION=-g9bf51ae87\r\nID=buildroot\r\nVERSION_ID=2023.02.6\r\nPRETTY_NAME="Buildroot 2023.02.6"\r\narmv7l\n'})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Windows PC with WiFi and Ethernet adapter"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"network-overview",children:"Network Overview"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"radxa"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"windows"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"luckfox"}),(0,i.jsx)(n.th,{style:{textAlign:"center"},children:"internet"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"WAN"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"LAN1"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"LAN2"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ETH3"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"LAN3"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ETH0"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"USBDebug"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"USB"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"ETH4"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"USB RNDIS"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Wi-Fi"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"-"}),(0,i.jsx)(n.td,{style:{textAlign:"center"},children:"Wi-Fi Network"})]})]})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502  Radxa   \u2502  Windows   \u2502  Luckfox   \u2502  Internet    \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502 WAN      \u2502            \u2502            \u2502              \u2502\r\n\u2502 LAN1     \u2502            \u2502            \u2502              \u2502\r\n\u2502 LAN2\u2500\u2500\u2500\u2500\u2500\u253c\u2500ETH3       \u2502            \u2502              \u2502\r\n\u2502 LAN3\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500ETH0       \u2502              |\r\n\u2502 USBDebug\u2500\u253c\u2500USB        \u2502            \u2502              \u2502\r\n\u2502          \u2502 ETH4\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500USB RNDIS  \u2502              \u2502\r\n\u2502          \u2502 Wi-Fi\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500Wi-Fi Network\u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.h2,{id:"notes",children:"Notes"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Bridges are like switches, they operate at Layer 2 of the OSI model, they use MAC addresses."}),"\n",(0,i.jsx)(n.li,{children:"Routers operate at layer 3 IP addresses"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["That means devices connected to a bridge for example ",(0,i.jsx)(n.code,{children:"eth1"})," deviceA and ",(0,i.jsx)(n.code,{children:"eth2"})," deviceB will be able to communicate, ",(0,i.jsx)(n.strong,{children:"if they are on the same network"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"deviceA Windows Machine\r\nip: 172.16.1.10/24\r\n\r\ndeviceB Luckfox Pico Pro/Max\r\nip: 172.16.1.20/24\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Clarification on CIDR notation",type:"note",children:(0,i.jsxs)(n.p,{children:["10.10.10.0/24 is the network",(0,i.jsx)(n.br,{}),"\n","10.10.10.1/24 is the address"]})}),"\n",(0,i.jsx)(n.h2,{id:"tasks",children:"Tasks"}),"\n",(0,i.jsxs)(n.ol,{start:"0",children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"#0-prepare-devices",children:"Prepare devices"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"DeviceA, Windows Machine"}),"\n",(0,i.jsx)(n.li,{children:"DeviceB, Luckfox"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsxs)(n.a,{href:"#1-create-bridge-on-the-host-device-between-eth1-and-eth2-call-it-br0",children:["Create bridge on the host device between ",(0,i.jsx)(n.code,{children:"eth1"})," and ",(0,i.jsx)(n.code,{children:"eth2"})," (br0)"]})}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.a,{href:"#2-connect-devicea-to-eth1-and-deviceb-to-eht2-set-static-ips-in-network-172161024",children:["Connect deviceA to ",(0,i.jsx)(n.code,{children:"eth1"})," and deviceB to ",(0,i.jsx)(n.code,{children:"eth2"}),", set static IPs"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Checks"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsxs)(n.a,{href:"#3-set-an-ip-address-of-the-bridge-br0-so-we-can-have-access-to-both-devices-from-the-host",children:["Set an IP address for the bridge ",(0,i.jsx)(n.code,{children:"br0"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Checks"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"0-prepare-devices",children:"0. Prepare devices"}),"\n",(0,i.jsx)(n.h4,{id:"radxa",children:"RADXA"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Installing the needed packages"}),"\n",(0,i.jsx)(n.p,{children:"1.1 Make sure you have internet connection"}),"\n",(0,i.jsx)(n.admonition,{title:"sharing internet from Windows PC via Wi-Fi to Ethernet",type:"note",children:(0,i.jsxs)(n.p,{children:["Go to WiFi adapter properties/Sharing/internetConnection sharing, mark the checkbox and select the network adapter to share with ",(0,i.jsx)(n.br,{}),"\n","Note the IP will be changed to ",(0,i.jsx)(n.code,{children:"192.168.137.1"})," and a DHCP server will be active on this port, so make sure the RADXA ETH port is set to automatic ip address"]})}),"\n",(0,i.jsx)(n.p,{children:"1.2 Connect to the radxa via the USBDebug with putty and change the IP addres:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Open PuTTY and configure as follows:"}),"\n",(0,i.jsx)(n.li,{children:"Select Serial for connection type"}),"\n",(0,i.jsx)(n.li,{children:"Enter the COM port number in the Serial line field (check in device manager)"}),"\n",(0,i.jsxs)(n.li,{children:["Set Speed to ",(0,i.jsx)(n.code,{children:"1500000"})]}),"\n",(0,i.jsx)(n.li,{children:"Select Serial for Connection type"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["when connected use the already installed ",(0,i.jsx)(n.code,{children:"nmtui"})," package to change the LAN2 adapter to automatic dhcp client ",(0,i.jsx)(n.br,{}),"\n","then get the ip of the radxa"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"ip a show\n"})}),"\n",(0,i.jsx)(n.p,{children:"1.3 update package list"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"sudo apt update\n"})}),"\n",(0,i.jsxs)(n.p,{children:["1.4 search for the package, if already installed skip ",(0,i.jsx)(n.code,{children:"apt install bridge-utils"})]}),"\n",(0,i.jsx)(n.admonition,{title:"bridge-utils obsolete",type:"note",children:(0,i.jsx)(n.p,{children:"bridge-utils is obolete it is included in the iproute2 package and we will use iproute2 in the next steps"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:" radxa@radxa-e54c:~$ sudo apt search bridge-utils\r\n Sorting... Done\r\n Full Text Search... Done\r\n bridge-utils/stable,now 1.7.1-1 arm64 [installed]\r\n Utilities for configuring the Linux Ethernet bridge\n"})}),"\n","\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"devicea-windows-machine",children:"DeviceA, Windows Machine"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Go to Network Connections > ",(0,i.jsx)(n.code,{children:"Win+R"})," type ",(0,i.jsx)(n.code,{children:"ncpa.cpl"})," remove the sharing from the WiFi and set the ip address of the Ethernet Adapter connected to the Radxa to ",(0,i.jsx)(n.code,{children:"172.16.1.10/24"})]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"deviceb-luckfox",children:"DeviceB, Luckfox"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://wiki.luckfox.com/Luckfox-Pico/Luckfox-Pico-RV1106/Luckfox-Pico-Pro-Max/Luckfox-Pico-Flash-burn-image",children:"Install the buildroot OS on the spi flash"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://wiki.luckfox.com/Luckfox-Pico/Luckfox-Pico-RV1106/Luckfox-Pico-Pro-Max/SSH-Telnet-Login",children:"Connect to it via the USB interface"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["When connecting Luckfox to the usb a virtual network port on the windows machine will be created",(0,i.jsx)(n.br,{}),"\n","USB virtual dongles have a ",(0,i.jsx)(n.strong,{children:"static"})," IP address of ",(0,i.jsx)(n.strong,{children:"172.32.0.93"})," Before using it, you need to set up the RNDIS virtual network port.",(0,i.jsx)(n.br,{}),"\n","Look for a Network Adapter with something like ",(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.em,{children:"Remote NDIS based internet Sharing Device"})})," in the Network Connections.",(0,i.jsx)(n.br,{}),"\n","Change the address of the windows Network Adapter to: ",(0,i.jsx)(n.br,{}),"\n","IP address: 172.32.0.100 ",(0,i.jsx)(n.br,{}),"\n","subnet mask: 255.255.0.0"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Create a script in ",(0,i.jsx)(n.code,{children:"/etc/init.d"})," check ",(0,i.jsx)(n.a,{href:"https://wiki.luckfox.com/Luckfox-Pico/Luckfox-Pico-RV1103/Luckfox-Pico-Plus-Mini/Luckfox-Pico-Autostart",children:"this"})," out ",(0,i.jsx)(n.br,{}),"\n","Why? ",(0,i.jsx)(n.br,{}),"\n","Buildroot with BusyBox init follows SysV-style init scripts for boot-time actions, hence changing /etc/network/interfaces won't work. ",(0,i.jsx)(n.br,{}),"\n","It runs at boot because BusyBox init uses ",(0,i.jsx)(n.code,{children:"/etc/inittab"})," \u2192 runs ",(0,i.jsx)(n.code,{children:"/etc/init.d/rcS"})," \u2192 runs all S* scripts."]}),"\n",(0,i.jsxs)(n.p,{children:["3.1. Luckfox buildroot image is using ",(0,i.jsx)(n.a,{href:"https://www.busybox.net/downloads/BusyBox.html",children:"BusyBox"})," - The Swiss Army Knife of Embedded Linux\\"]}),"\n",(0,i.jsx)(n.p,{children:"Create a startup script to wait 50 sec for dhcp server else set a static ip address"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"adjust the priority of system scripts"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/init.d"',children:"mv S99usb0config S90usb0config\r\nmv S99_auto_reboot S90_auto_reboot\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["create a script ",(0,i.jsx)(n.code,{children:"vi etc/init.d/S99_static_ip"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="/etc/init.d/S99_static_ip"',children:'#!/bin/sh\r\n\r\necho "### Static IP script ###"\r\n\r\nMAX_RETRIES=10\r\nTRIES=0\r\nUSER_IP=172.16.1.20/24\r\n\r\ncheck_ip_address(){\r\nif ip a show eth0 | grep -q "inet" ; then\r\n          echo "inet found"\r\n          return 0\r\n     else\r\n          echo "inet not found"\r\n     return 1\r\nfi\r\n}\r\n\r\n# check if we have ip by DHCP\r\n\r\nwait_dhcp() {\r\nwhile [ $TRIES -lt $MAX_RETRIES ]; do\r\n     if check_ip_address ; then\r\n          echo "DHCP succeed!"\r\n          exit 0\r\n     else\r\n          echo "$((TRIES + 1))/$MAX_RETRIES wait for DHCP IP..."\r\n          TRIES=$((TRIES + 1))\r\n     sleep 5\r\n     fi\r\ndone\r\n}\r\n\r\n# set static IP\r\n\r\nset_static_ip() {\r\necho "giving static IP $USER_IP"\r\nip addr add $USER_IP dev eth0\r\nip a show dev eth0\r\n}\r\n\r\ncase $1 in\r\ncheck)\r\n     check_ip_address\r\n     ;;\r\nstart)\r\n     echo "start"\r\n     wait_dhcp\r\n     set_static_ip\r\n     ;;\r\nstop)\r\n     echo "stop"\r\n     ;;\r\n\\*)\r\n     exit 1\r\n     ;;\r\nesac\r\n\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"make the script executable"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"chmod +x /etc/init.d/S99_static_ip\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.h3,{id:"1-create-bridge-on-the-host-device-radxa-between-lan2-and-lan3-call-it-br0",children:["1. Create bridge on the host device (RADXA) between ",(0,i.jsx)(n.code,{children:"lan2"})," and ",(0,i.jsx)(n.code,{children:"lan3"})," call it ",(0,i.jsx)(n.code,{children:"br0"})]}),"\n",(0,i.jsx)(n.p,{children:"While connected with PuTTY"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="add bridge device"',children:"sudo ip link add name br0 type bridge\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["see ",(0,i.jsx)(n.code,{children:"man ip-link(8)"})]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="turn interfaces down"',children:"sudo ip link set lan2 down\r\nsudo ip link set lan3 down\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="add interfaces to the bridge"',children:"sudo ip link set lan2 master br0\r\nsudo ip link set lan3 master br0\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="check interfaces"',children:"radxa@radxa-e54c:~$ sudo ip link\r\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000\r\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r\n2: end1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1508 qdisc mq state UP mode DEFAULT group default qlen 1000\r\n    link/ether 46:ed:77:9f:2f:81 brd ff:ff:ff:ff:ff:ff\r\n3: lan3@end1: <BROADCAST,MULTICAST> mtu 1500 qdisc noqueue master br0 state DOWN mode DEFAULT group default qlen 1000\r\n    link/ether 00:48:54:20:00:03 brd ff:ff:ff:ff:ff:ff\r\n4: lan2@end1: <BROADCAST,MULTICAST> mtu 1500 qdisc noqueue master br0 state DOWN mode DEFAULT group default qlen 1000\r\n    link/ether 00:48:54:20:00:02 brd ff:ff:ff:ff:ff:ff\r\n5: lan1@end1: <BROADCAST,MULTICAST> mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default qlen 1000\r\n    link/ether 00:48:54:20:00:01 brd ff:ff:ff:ff:ff:ff\r\n6: wan@end1: <NO-CARRIER,BROADCAST,MULTICAST,UP> mtu 1500 qdisc noqueue state LOWERLAYERDOWN mode DEFAULT group default qlen 1000\r\n    link/ether 00:48:54:20:00:00 brd ff:ff:ff:ff:ff:ff\r\n7: br0: <BROADCAST,MULTICAST> mtu 1500 qdisc noqueue state DOWN mode DEFAULT group default qlen 1000\r\n    link/ether ba:37:11:86:dd:71 brd ff:ff:ff:ff:ff:ff\r\n\n"})}),"\n",(0,i.jsxs)(n.p,{children:["We can see that ",(0,i.jsx)(n.code,{children:"3: lan3"})," and ",(0,i.jsx)(n.code,{children:"4: lan2"})," are with master ",(0,i.jsx)(n.code,{children:"7: br0"})," ",(0,i.jsx)(n.br,{}),"\n","Another way is to check with ",(0,i.jsx)(n.code,{children:"bridge"})," command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="check bridged interfaces"',children:"radxa@radxa-e54c:~$ sudo bridge link\r\n3: lan3@end1: <BROADCAST,MULTICAST> mtu 1500 master br0 state disabled priority 32 cost 19\r\n4: lan2@end1: <BROADCAST,MULTICAST> mtu 1500 master br0 state disabled priority 32 cost 19\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="bring interfaces up"',children:"sudo ip link set lan2 up\r\nsudo ip link set lan3 up\r\nsudo ip link set br0 up\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"2-connect-devicea-to-eth1-and-deviceb-to-eht2-set-static-ips-in-network-172161024",children:["2. Connect deviceA to ",(0,i.jsx)(n.code,{children:"eth1"})," and deviceB to ",(0,i.jsx)(n.code,{children:"eht2"})," set static IPs in network 172.16.1.0/24"]}),"\n",(0,i.jsxs)(n.p,{children:["At this step we have already configured the adresses of the luckfox ",(0,i.jsx)(n.code,{children:"172.16.1.20/24"})," and the windows PC ",(0,i.jsx)(n.code,{children:"172.16.1.10/24"}),", time to check the bridge"]}),"\n",(0,i.jsx)(n.h4,{id:"checks",children:"Checks"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check connectivity from deviceA to deviceB and vice versa"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",metastring:'title="windows PC -> luckfox"',children:"PS C:\\Users\\kolev> ping  172.16.1.20\r\n\r\nPinging 172.16.1.20 with 32 bytes of data:\r\nReply from 172.16.1.20: bytes=32 time=2ms TTL=64\r\nReply from 172.16.1.20: bytes=32 time=2ms TTL=64\r\nReply from 172.16.1.20: bytes=32 time=2ms TTL=64\r\nReply from 172.16.1.20: bytes=32 time=2ms TTL=64\r\n\r\nPing statistics for 172.16.1.20:\r\n    Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),\r\nApproximate round trip times in milli-seconds:\r\n    Minimum = 2ms, Maximum = 2ms, Average = 2ms\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Using the virtual network with RNDIS connection coonect from pc to luckfox ",(0,i.jsx)(n.code,{children:"root@172.32.0.93"})," and chek the ",(0,i.jsx)(n.code,{children:"luckfox eth0"})," interface connection"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",metastring:'title="luckfox -> windows PC"',children:"[root@luckfox-bk root]# ping 172.16.1.10\r\nPING 172.16.1.10 (172.16.1.10): 56 data bytes\r\n64 bytes from 172.16.1.10: seq=0 ttl=128 time=2.769 ms\r\n64 bytes from 172.16.1.10: seq=1 ttl=128 time=2.822 ms\r\n64 bytes from 172.16.1.10: seq=2 ttl=128 time=3.113 ms\r\n64 bytes from 172.16.1.10: seq=3 ttl=128 time=2.698 ms\r\n64 bytes from 172.16.1.10: seq=4 ttl=128 time=2.893 ms\r\n64 bytes from 172.16.1.10: seq=5 ttl=128 time=2.785 ms\r\n^C\r\n--- 172.16.1.10 ping statistics ---\r\n6 packets transmitted, 6 packets received, 0% packet loss\r\nround-trip min/avg/max = 2.698/2.846/3.113 ms\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Now we can try to log to the luckfox from the address ",(0,i.jsx)(n.code,{children:"172.16.1.20"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-powershell",metastring:'title="login to luckfox through ethernet interface"',children:"PS C:\\Users\\kolev> ssh   root@172.16.1.20\r\nThe authenticity of host '172.16.1.20 (172.16.1.20)' can't be established.\r\nED25519 key fingerprint is SHA256:sGpar00ySOKpakv4SxHZ806d4xRdOeFr/8DyH/YF05I.\r\nThis host key is known by the following other names/addresses:\r\n    C:\\Users\\kolev/.ssh/known_hosts:55: 172.32.0.93\r\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes\r\nWarning: Permanently added '172.16.1.20' (ED25519) to the list of known hosts.\r\nroot@172.16.1.20's password:\r\n[root@luckfox-bk root]# ip a\r\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue qlen 1000\r\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\r\n    inet 127.0.0.1/8 scope host lo\r\n       valid_lft forever preferred_lft forever\r\n2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc mq qlen 1000\r\n    link/ether fe:39:bd:06:be:63 brd ff:ff:ff:ff:ff:ff\r\n    inet 172.16.1.20/24 scope global eth0\r\n       valid_lft forever preferred_lft forever\r\n3: usb0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast qlen 1000\r\n    link/ether 36:02:64:2b:3f:8a brd ff:ff:ff:ff:ff:ff\r\n    inet 172.32.0.93/16 brd 172.32.255.255 scope global usb0\r\n       valid_lft forever preferred_lft forever\n"})}),"\n",(0,i.jsx)(n.h3,{id:"3-set-an-ip-address-of-the-bridge-br0-so-we-can-have-access-to-both-devices-from-the-host",children:"3. Set an ip address of the bridge br0 so we can have access to both devices from the host"}),"\n",(0,i.jsx)(n.h4,{id:"checks-1",children:"Checks"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Check connection to Windows PC from bridge host (radxa) and vice versa"}),"\n",(0,i.jsx)(n.li,{children:"Check connection to luckfox pico from bridge host (radxa) and vice versa"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>c});var r=t(6540);const i={},s=r.createContext(i);function d(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);