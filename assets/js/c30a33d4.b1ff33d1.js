"use strict";(self.webpackChunktaking_notes=self.webpackChunktaking_notes||[]).push([[5906],{6023:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>u});var s=i(2538),t=i(4848),r=i(8453),l=i(1470),c=i(9365);const a={slug:"luckfox rv1106g canbus mcp2518fd",title:"Running can bus on embedded linux - Luckfox Pico Ultra rv1106g",authors:["boris"],tags:["luckfox","buildroot","can","canbus","kernel","dts","mcp251xfd","mcp2518fd","linux"]},o=void 0,d={authorsImageUrls:[void 0]},u=[{value:"Lab setup",id:"lab-setup",level:2},{value:"Buildroot",id:"buildroot",level:2},{value:"Add the packages in buildroot",id:"add-the-packages-in-buildroot",level:3},{value:"Kernel config",id:"kernel-config",level:2},{value:"Configuring the Kernel",id:"configuring-the-kernel",level:3},{value:"Device Tree",id:"device-tree",level:3},{value:"1. Modify the <code>dts</code>",id:"1-modify-the-dts",level:4},{value:"2. Modify the <code>.dtsi</code>",id:"2-modify-the-dtsi",level:4},{value:"Final preparation",id:"final-preparation",level:2},{value:"End Result",id:"end-result",level:2},{value:"References",id:"references",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Table of Contents:"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#lab-setup",children:"Lab setup"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#buildroot",children:"Buildroot"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#add-the-packages-in-buildroot",children:"Add the packages in buildroot"})}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#kernel-config",children:"Kernel config"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#configuring-the-kernel",children:"Configuring the Kernel"})}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.a,{href:"#device-tree",children:"Device Tree"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsxs)(n.a,{href:"#1-modify-the-dts",children:["1. Modify the ",(0,t.jsx)(n.code,{children:"dts"})]})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsxs)(n.a,{href:"#2-modify-the-dtsi",children:["2. Modify the ",(0,t.jsx)(n.code,{children:".dtsi"})]})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#final-preparation",children:"Final preparation"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#end-result",children:"End Result"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"#references",children:"References"})}),"\n"]}),"\n","\n",(0,t.jsx)(n.h2,{id:"lab-setup",children:"Lab setup"}),"\n",(0,t.jsxs)(n.p,{children:["The SBC ",(0,t.jsx)(n.em,{children:"luckfox-pico-ultra"})," is mounted on a custom made motherboard with some external peripherals such as can bus and isolated rs-485"]}),"\n",(0,t.jsxs)(n.p,{children:["SBC: ",(0,t.jsx)(n.a,{href:"https://www.luckfox.com/Luckfox-Pico/EN-Luckfox-Pico-Ultra",children:"Luckfox Pico Ultra W rv1106g 8GB"}),(0,t.jsx)(n.br,{}),"\n","Custom motherboard: ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(152).A+"",children:"schematics"})]}),"\n",(0,t.jsxs)(n.p,{children:["I am using the containerized Luckfox SDK docker image ",(0,t.jsx)(n.code,{children:"luckfoxtech/luckfox_pico:1.0"})," for build environment.\nAs image flashing tool: ",(0,t.jsx)(n.code,{children:"SOC Toolkit"})," for Windows. The whole system image flashing procedure is well documented in the ",(0,t.jsx)(n.a,{href:"https://wiki.luckfox.com/Luckfox-Pico-Ultra/Flash-image",children:"official wiki"})]}),"\n",(0,t.jsx)(n.h2,{id:"buildroot",children:"Buildroot"}),"\n",(0,t.jsx)(n.h3,{id:"add-the-packages-in-buildroot",children:"Add the packages in buildroot"}),"\n",(0,t.jsxs)(l.A,{children:[(0,t.jsxs)(c.A,{value:"1. can-utils",children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"can-utils"})," includes ",(0,t.jsx)(n.code,{children:"candump"}),", ",(0,t.jsx)(n.code,{children:"cansend"}),", ",(0,t.jsx)(n.code,{children:"cansniffer"})," etc"]}),(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"packages-1",src:i(6403).A+"",width:"746",height:"576"})})]}),(0,t.jsxs)(c.A,{value:"2. iproute2",children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"iproute2"})," is the Linux networking toolkit that replaced net-tools (ifconfig, route, arp etc.)",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://paulgorman.org/technical/linux-iproute2-cheatsheet.html",children:"iproute2 cheatsheet"})]}),(0,t.jsx)("div",{style:{width:"80"},children:(0,t.jsx)(n.img,{alt:"packages-2",src:i(9544).A+"",width:"736",height:"588"})})]})]}),"\n",(0,t.jsx)(n.h2,{id:"kernel-config",children:"Kernel config"}),"\n",(0,t.jsx)(n.h3,{id:"configuring-the-kernel",children:"Configuring the Kernel"}),"\n",(0,t.jsxs)(l.A,{children:[(0,t.jsxs)(c.A,{value:"1. Set a local version",children:[(0,t.jsxs)(n.p,{children:["It is good to set the kernel a local version name, so you can later check what is the kernel image on the SBC with ",(0,t.jsx)(n.code,{children:"uname"})]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"General Setup ---\x3e\n ()Local version - append to kernel release\n"})}),(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"kernel-local-version",src:i(9478).A+"",width:"740",height:"591"})})]}),(0,t.jsxs)(c.A,{value:"2. Enable the SPI",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"Device Drivers ---\x3e\n  [*] SPI support\n"})}),(0,t.jsxs)(n.p,{children:[(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"kernel-local-version",src:i(9056).A+"",width:"742",height:"589"})}),"\nIt is also helpful to enable the Debug support for SPI drivers, one menu deep inside SPI support"]})]}),(0,t.jsxs)(c.A,{value:"3. Enable CAN-SPI driver",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"  Networking support ---\x3e  \n   CAN bus subsystem support ---\x3e  \n    CAN Device Drivers ---\x3e  \n     CAN SPI interfaces ---\x3e\n      <*> Microchip MCP251xFD SPI CAN controllers\n"})}),(0,t.jsx)("div",{style:{width:"50"},children:(0,t.jsx)(n.img,{alt:"kernel-local-version",src:i(8830).A+"",width:"743",height:"592"})}),(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"kernel-local-version",src:i(6661).A+"",width:"737",height:"589"})})]})]}),"\n",(0,t.jsx)(n.h3,{id:"device-tree",children:"Device Tree"}),"\n",(0,t.jsx)(n.p,{children:"According to Luckfox:"}),"\n",(0,t.jsxs)(n.blockquote,{children:["\n",(0,t.jsx)(n.p,{children:"For Luckfox Pico, the basic device tree configurations related to the RV1103 / RV1106 chips\u2014such as rv1106.dtsi, rv1106-pinctrl.dtsi, etc.\u2014are provided by Rockchip. Based on the hardware resources available on the Luckfox Pico, the default configurations are set in .dtsi files, while model-specific hardware information is defined in .dts files."}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"The configurations in .dts files have the highest priority and can override settings in the .dtsi files. You can reference nodes from .dtsi and either modify their properties or recreate them entirely."}),"\n",(0,t.jsxs)(n.li,{children:["For easier editing, the .dts file corresponding to the selected board support package is symlinked to ",(0,t.jsx)(n.code,{children:"<luckfox-pico SDK>/config/dts_config"})," after running ./build.sh. Normally, you only need to edit the .dts file to configure hardware features\u2014.dtsi files should not be modified."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{alt:"dts-tree",src:i(4569).A+"",width:"503",height:"372"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"dts"})," files are located under ",(0,t.jsx)(n.code,{children:"<SDK-folder>/sysdrv/source/kernel/arch/arm/boot/dts"})," the ones that we need are named as follows:"]}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{style:{textAlign:"center"},children:"sbc"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:".dts"}),(0,t.jsx)(n.th,{style:{textAlign:"center"},children:".dtsi"})]})}),(0,t.jsx)(n.tbody,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"Luckfox Pico ultra W"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"rv1106g-luckfox-pico-ultra-w.dts"}),(0,t.jsx)(n.td,{style:{textAlign:"center"},children:"rv1106-luckfox-pico-ultra-ipc.dtsi"})]})})]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.a,{href:"https://wiki.luckfox.com/Luckfox-Pico-Ultra/Device-Tree",children:"(check here for others)"})}),"\n",(0,t.jsxs)(n.h4,{id:"1-modify-the-dts",children:["1. Modify the ",(0,t.jsx)(n.code,{children:"dts"})]}),"\n",(0,t.jsxs)(n.p,{children:["In the ",(0,t.jsx)(n.code,{children:".dts"})," file you can see that I have removed a lot of things for the sake of simplicity and the lab itself (running the CAN). The missing parts are mainly regarding the ",(0,t.jsx)(n.code,{children:"BT"})," and ",(0,t.jsx)(n.code,{children:"SDIO-WIFI"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["modified: ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(17).A+"",children:"rv1106g-luckfox-pico-ultra-w.dts"})]}),"\n",(0,t.jsxs)(n.li,{children:["original: ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(3773).A+"",children:"rv1106g-luckfox-pico-ultra-w.dts"})]}),"\n"]}),"\n",(0,t.jsxs)(l.A,{children:[(0,t.jsx)(c.A,{value:"1. Modified dts",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-C",metastring:'title="rv1106g-luckfox-pico-ultra-w.dts"',children:'// SPDX-License-Identifier: (GPL-2.0+ OR MIT)\n/*\n* Copyright (c) 2022 Rockchip Electronics Co., Ltd.\n*/\n\n/dts-v1/;\n#include "rv1106.dtsi"\n#include "rv1106-luckfox-pico-ultra-ipc.dtsi"\n#include <dt-bindings/input/input.h>\n#include <dt-bindings/display/media-bus-format.h>\n\n/ {\n        ***>\n        clk_mcp251xfd: clk_mcp251xfd {\n                compatible = "fixed-clock";\n                #clock-cells = <0>;\n                clock-frequency = <40000000>;\n        };\n        ***<\n};\n***>\n/**********SPI**********/\n&spi0 {\n        status = "okay";\n        pinctrl-0 = <&spi0m0_clk &spi0m0_miso &spi0m0_mosi &spi0m0_cs0>;\n        #address-cells = <1>;\n        #size-cells = <0>;\n        spidev@0 {\n                status = "okay";\n                compatible = "microchip,mcp251xfd";\n                reg = <0>;\n                spi-max-frequency = <4000000>;\n                interrupts = <RK_PC6 IRQ_TYPE_LEVEL_LOW>;\n                interrupt-parent = <&gpio1>;\n                clocks = <&clk_mcp251xfd>;\n                clock-names = "mcp251xfd";\n                vdd-supply = <&vcc_3v3>;\n                xceiver-supply = <&vcc_3v3>;\n        };\n};\n***<\n'})})}),(0,t.jsxs)(c.A,{value:"2. clock frequency",children:[(0,t.jsxs)(n.p,{children:["here the ",(0,t.jsx)(n.code,{children:"clock-frequency"})," must be the equal to the oscillator of the board used e.g. if the oscillator is 20MHz it should be 20000000 in our case we use 40MHz, otherwise it just won't work"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-C",metastring:'title="rv1106g-luckfox-pico-ultra-w.dts"',children:'***>\nclk_mcp251xfd: clk_mcp251xfd {\n              compatible = "fixed-clock";\n              #clock-cells = <0>;\n              clock-frequency = <40000000>;\n      };\n***<\n'})}),(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"mcp-oscillator",src:i(5407).A+"",width:"956",height:"593"})})]}),(0,t.jsxs)(c.A,{value:"3. interrupts",children:[(0,t.jsx)(n.p,{children:"As pin for the interrupt we are using C6 from the luckfox board which should be configured as interrupt Input pin active on Low level"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-C",metastring:'title="rv1106g-luckfox-pico-ultra-w.dts"',children:'***>\n/**********SPI**********/\n&spi0 {\n      status = "okay";\n      pinctrl-0 = <&spi0m0_clk &spi0m0_miso &spi0m0_mosi &spi0m0_cs0>;\n      #address-cells = <1>;\n      #size-cells = <0>;\n      spidev@0 {\n              status = "okay";\n              compatible = "microchip,mcp251xfd";\n              reg = <0>;\n              spi-max-frequency = <4000000>;\n              interrupts = <RK_PC6 IRQ_TYPE_LEVEL_LOW>;\n              interrupt-parent = <&gpio1>;\n              clocks = <&clk_mcp251xfd>;\n              clock-names = "mcp251xfd";\n              vdd-supply = <&vcc_3v3>;\n              xceiver-supply = <&vcc_3v3>;\n      };\n};\n***<\n'})}),(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"dts-02",src:i(6386).A+"",width:"708",height:"587"})}),(0,t.jsx)("div",{style:{width:"100"},children:(0,t.jsx)(n.img,{alt:"dts-03",src:i(7515).A+"",width:"967",height:"502"})})]})]}),"\n",(0,t.jsxs)(n.h4,{id:"2-modify-the-dtsi",children:["2. Modify the ",(0,t.jsx)(n.code,{children:".dtsi"})]}),"\n",(0,t.jsxs)(n.p,{children:["Here I have removed ",(0,t.jsx)(n.code,{children:"CSI"}),", ",(0,t.jsx)(n.code,{children:"LCD/TP"})," and the things related to the RGB,\nbecause some pins are needed for interrupt of the ",(0,t.jsx)(n.code,{children:"mcp2518fd"})," chip."]}),"\n",(0,t.jsx)(n.p,{children:"You can compare them to see the full changes e.g. with WinMerge:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["modified ",(0,t.jsx)(n.code,{children:".dtsi"})," : ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(3812).A+"",children:"rv1106-luckfox-pico-ultra-ipc.dtsi"})]}),"\n",(0,t.jsxs)(n.li,{children:["original ",(0,t.jsx)(n.code,{children:".dtsi"})," : ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:i(3084).A+"",children:"rv1106-luckfox-pico-ultra-ipc.dtsi"})]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["The configurations in .dts files have the highest priority and can override settings in the .dtsi files, so\nthe ",(0,t.jsx)(n.code,{children:"clk_mcp2515"})," in the root node  and ",(0,t.jsx)(n.code,{children:"&spi0"})," are overwrited by the dts so their prop values are not applied."]})}),"\n",(0,t.jsx)(l.A,{children:(0,t.jsx)(c.A,{value:"Modified dts",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-C",metastring:'title="rv1106-luckfox-pico-ultra-ipc.dtsi"',children:'// SPDX-License-Identifier: (GPL-2.0+ OR MIT)\n/*\n* Copyright (c) 2022 Rockchip Electronics Co., Ltd.\n*/\n\n#include "rv1106-evb.dtsi"\n#include <dt-bindings/input/input.h>\n#include <dt-bindings/display/media-bus-format.h>\n\n/ {\n       ***>\n        clk_mcp2515: clk_mcp2515 {\n                        compatible = "fixed-clock";\n                        #clock-cells = <0>;\n                        clock-frequency = <8000000>;\n        };\n       ***<\n};\n\n***>\n// SPI\n&spi0 {\n        pinctrl-0 = <&spi0m0_clk &spi0m0_miso &spi0m0_mosi &spi0m0_cs0>;\n        #address-cells = <1>;\n        #size-cells = <0>;\n        spidev@0 {\n                compatible = "rockchip,spidev";\n                spi-max-frequency = <50000000>;\n                reg = <0>;\n        };\n\n};\n***<\n&pinctrl {\n  ***>\n        spi0 {\n                spi0m0_clk: spi0m0-clk {\n                        rockchip,pins = <1 RK_PC1 4 &pcfg_pull_none>;\n                };\n                spi0m0_mosi: spi0m0-mosi {\n                        rockchip,pins = <1 RK_PC2 6 &pcfg_pull_none>;\n                };\n                spi0m0_miso: spi0m0-miso {\n                        rockchip,pins = <1 RK_PC3 6 &pcfg_pull_none>;\n                };\n                spi0m0_cs0: spi0m0-cs0 {\n                        rockchip,pins = <1 RK_PC0 4 &pcfg_pull_none>;\n                };\n        };\n  ***<\n};\n'})})})}),"\n",(0,t.jsx)(n.h2,{id:"final-preparation",children:"Final preparation"}),"\n",(0,t.jsxs)(n.p,{children:["Build the image with the ",(0,t.jsx)(n.code,{children:"SDK"})," and upload it with the ",(0,t.jsx)(n.code,{children:"SOC toolkit"})]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Useful commands in host machine:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"# attach to the container with the SDK\ndocker attach <container-name>   \n\n# when inside the SDK folder to see options\n./build.sh help  \n\n# copy a file/folder from docker container to current directory \ndocker cp <container-name>:<full-path-to-sdk>/IMAGE/IPC_EMMC_BUILDROOT_RV1106_LUCKFOX_PICO_ULTRA_W_20251125.2257_RELEASE_TEST .    \n\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"useful commands in embedded device:"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'# check kernel messages regarding mcp can or spi\ndmesg | grep -E "mcp|can|spi"\n\n# prepare the can0 interface link\nip link set can0 type can bitrate 500000\n\n# set the can bus Up and active\nip link set can0 up\n\n# check recieved messages with candump\ncandump can0\n\n# make automatic start of the interface on boot\nvim /etc/network/interfaces\n\n  auto lo\n  iface lo inet loopback\n\n  auto can0\n    iface can0 inet manual\n    up /sbin/ip link set can0 up type can bitrate 500000\n    down /sbin/ip link set can0 down\n\n'})}),"\n",(0,t.jsx)(n.h2,{id:"end-result",children:"End Result"}),"\n",(0,t.jsxs)(n.p,{children:["After successful build and upload, login the Luckfox and type ",(0,t.jsx)(n.code,{children:"dmesg | grep mcp"}),", you should see something similar:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"[    0.165740] mcp251xfd spi0.0: setup mode 0, 8 bits/w, 4000000 Hz max --\x3e 0\n[    0.165812] mcp251xfd spi0.0: can_rx_offload_init_queue: skb_queue_len_max=512\n[    0.172937] mcp251xfd spi0.0 can0: MCP2518FD rev0.0 (-RX_INT -MAB_NO_WARN +CRC_REG +CRC_RX +CRC_TX +ECC -HD c:40.00MHz m:4.00MHz r:4.00MHz e:0.00MHz) successfully initialized.\n"})}),"\n",(0,t.jsx)(n.p,{children:"This is okay and the can chip has been initialized"}),"\n",(0,t.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://forums.luckfox.com/viewtopic.php?p=4290&hilit=mcp2515#p4290",children:"Luckfox Forum"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://www.devicetree.org/specifications",children:"DeviceTree.org"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://github.com/LuckfoxTECH/luckfox-pico/blob/994243753789e1b40ef91122e8b3688aae8f01b8/sysdrv/source/kernel/arch/arm/boot/dts/rv1106-luckfox-pico-ultra-ipc.dtsi",children:"rv1106-luckfox-pico-ultra-ipc.dtsi"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://github.com/LuckfoxTECH/luckfox-pico/blob/994243753789e1b40ef91122e8b3688aae8f01b8/sysdrv/source/kernel/arch/arm/boot/dts/rv1106g-luckfox-pico-ultra-w.dts",children:"rv1106g-luckfox-pico-ultra-w.dts"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://github.com/LuckfoxTECH/luckfox-pico/blob/994243753789e1b40ef91122e8b3688aae8f01b8/sysdrv/source/kernel/include/dt-bindings/interrupt-controller/irq.h",children:"irq.h"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://github.com/LuckfoxTECH/luckfox-pico/blob/994243753789e1b40ef91122e8b3688aae8f01b8/media/sysutils/include/rk_gpio.h",children:"rk_gpio.h"}),(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.a,{href:"https://notes.rdu.im/system/linux/canbus/",children:"Ruixiang's Notes"})]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},9365:(e,n,i)=>{i.d(n,{A:()=>l});i(6540);var s=i(4164);const t={tabItem:"tabItem_Ymn6"};var r=i(4848);function l({children:e,hidden:n,className:i}){return(0,r.jsx)("div",{role:"tabpanel",className:(0,s.A)(t.tabItem,i),hidden:n,children:e})}},1470:(e,n,i)=>{i.d(n,{A:()=>y});var s=i(6540),t=i(4164),r=i(3104),l=i(6347),c=i(205),a=i(7485),o=i(1682),d=i(679);function u(e){return s.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,s.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:i}=e;return(0,s.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:i,default:s}})=>({value:e,label:n,attributes:i,default:s})))}(i);return function(e){const n=(0,o.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function p({value:e,tabValues:n}){return n.some((n=>n.value===e))}function f({queryString:e=!1,groupId:n}){const i=(0,l.W6)(),t=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,a.aZ)(t),(0,s.useCallback)((e=>{if(!t)return;const n=new URLSearchParams(i.location.search);n.set(t,e),i.replace({...i.location,search:n.toString()})}),[t,i])]}function x(e){const{defaultValue:n,queryString:i=!1,groupId:t}=e,r=h(e),[l,a]=(0,s.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const i=n.find((e=>e.default))??n[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:n,tabValues:r}))),[o,u]=f({queryString:i,groupId:t}),[x,m]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[i,t]=(0,d.Dv)(n);return[i,(0,s.useCallback)((e=>{n&&t.set(e)}),[n,t])]}({groupId:t}),g=(()=>{const e=o??x;return p({value:e,tabValues:r})?e:null})();(0,c.A)((()=>{g&&a(g)}),[g]);return{selectedValue:l,selectValue:(0,s.useCallback)((e=>{if(!p({value:e,tabValues:r}))throw new Error(`Can't select invalid tab value=${e}`);a(e),u(e),m(e)}),[u,m,r]),tabValues:r}}var m=i(2303);const g={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var b=i(4848);function k({className:e,block:n,selectedValue:i,selectValue:s,tabValues:l}){const c=[],{blockElementScrollPositionUntilNextRender:a}=(0,r.a_)(),o=e=>{const n=e.currentTarget,t=c.indexOf(n),r=l[t].value;r!==i&&(a(n),s(r))},d=e=>{let n=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const i=c.indexOf(e.currentTarget)+1;n=c[i]??c[0];break}case"ArrowLeft":{const i=c.indexOf(e.currentTarget)-1;n=c[i]??c[c.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":n},e),children:l.map((({value:e,label:n,attributes:s})=>(0,b.jsx)("li",{role:"tab",tabIndex:i===e?0:-1,"aria-selected":i===e,ref:e=>{c.push(e)},onKeyDown:d,onClick:o,...s,className:(0,t.A)("tabs__item",g.tabItem,s?.className,{"tabs__item--active":i===e}),children:n??e},e)))})}function j({lazy:e,children:n,selectedValue:i}){const r=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=r.find((e=>e.props.value===i));return e?(0,s.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:r.map(((e,n)=>(0,s.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function v(e){const n=x(e);return(0,b.jsxs)("div",{className:(0,t.A)("tabs-container",g.tabList),children:[(0,b.jsx)(k,{...n,...e}),(0,b.jsx)(j,{...n,...e})]})}function y(e){const n=(0,m.A)();return(0,b.jsx)(v,{...e,children:u(e.children)},String(n))}},152:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/custom-motherboard-8b88d5035818191d3482460d593d54b0.pdf"},3812:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/rv1106-luckfox-pico-ultra-ipc-modified-756482bb1eeb081dbcb4358e5f364a63.dtsi"},3084:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/rv1106-luckfox-pico-ultra-ipc-3fe7d680a1df1b1ea17f217dd67e34cc.dtsi"},17:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/rv1106g-luckfox-pico-ultra-w-modified-5547854a40c65cd809838b71b2a4125d.dts"},3773:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/files/rv1106g-luckfox-pico-ultra-w-2d1daddd9501df79a5c9e4f72f306fdd.dts"},4569:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/dts-01-b198b812875286b48f2211d30e32ce93.png"},6386:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/dts-02-7b2ac0d362596fb0c99af401578a1b7e.png"},7515:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/dts-03-ee2f18fc5c2a83c10a98d9012a146983.png"},8830:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/kernel-can-drivers-01-3788877007555cf49e30b2af1dc357e9.png"},6661:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/kernel-can-drivers-02-c1179bc98222e6b9d046db02cf06bd9a.png"},9478:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/kernel-local-version-ab1466021b3a222ec519b56950135aff.png"},9056:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/kernel-spi-support-124d68ae0461a59ddc6cdd94082901e5.png"},5407:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/mcp-oscillator-a22079a5da0e6ab1ef69adfc46313d58.png"},6403:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/packages-01-3826990006abc127ebcc2fa125c04bb9.png"},9544:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/packages-02-8eb1c128005216d952c5c1b6f2cfd0d3.png"},8453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>c});var s=i(6540);const t={},r=s.createContext(t);function l(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),s.createElement(r.Provider,{value:n},e.children)}},2538:e=>{e.exports=JSON.parse('{"permalink":"/blog/luckfox rv1106g canbus mcp2518fd","source":"@site/blog/2025-11-27-luckfox-rv1106g-canbus/index.md","title":"Running can bus on embedded linux - Luckfox Pico Ultra rv1106g","description":"Table of Contents:","date":"2025-11-27T00:00:00.000Z","tags":[{"inline":true,"label":"luckfox","permalink":"/blog/tags/luckfox"},{"inline":true,"label":"buildroot","permalink":"/blog/tags/buildroot"},{"inline":true,"label":"can","permalink":"/blog/tags/can"},{"inline":true,"label":"canbus","permalink":"/blog/tags/canbus"},{"inline":true,"label":"kernel","permalink":"/blog/tags/kernel"},{"inline":true,"label":"dts","permalink":"/blog/tags/dts"},{"inline":true,"label":"mcp251xfd","permalink":"/blog/tags/mcp-251-xfd"},{"inline":true,"label":"mcp2518fd","permalink":"/blog/tags/mcp-2518-fd"},{"inline":true,"label":"linux","permalink":"/blog/tags/linux"}],"readingTime":7.4,"hasTruncateMarker":true,"authors":[{"name":"Boris Kolev","title":"owner","key":"boris","page":null}],"frontMatter":{"slug":"luckfox rv1106g canbus mcp2518fd","title":"Running can bus on embedded linux - Luckfox Pico Ultra rv1106g","authors":["boris"],"tags":["luckfox","buildroot","can","canbus","kernel","dts","mcp251xfd","mcp2518fd","linux"]},"unlisted":false,"prevItem":{"title":"Teleoperation of SO-ARM101 on rpi 3B+ as a service","permalink":"/blog/rpi lerobot so-arm101 teleoperate"},"nextItem":{"title":"\u0415\u0433\u043e\u0442\u043e \u0435 \u0412\u0440\u0430\u0433\u044a\u0442 - \u0420\u0430\u0439\u044a\u043d \u0425\u043e\u043b\u0438\u0434\u0435\u0439, \u0438\u0437\u0431\u0440\u0430\u043d\u0438 \u043e\u0442\u043a\u044a\u0441\u0438","permalink":"/blog/ego-is-the-enemy"}}')}}]);